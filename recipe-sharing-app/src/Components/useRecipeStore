import { create } from "zustand";
import { persist } from "zustand/middleware";

// Define the store
const useRecipeStore = create(
  persist(
    (set:any) => ({
      recipes: [],

      // Adds a single recipe to the top of the list
      addRecipe: (newRecipe: any) => 
        set((state: { recipes: any; }) => ({ 
          recipes: [newRecipe, ...state.recipes] 
        })),

      // Replaces the entire list (useful for API initial loads)
      setRecipes: (recipes: any) => set({ recipes }),

      // Deletes a recipe by its unique ID
      deleteRecipe: (id: any) => 
        set((state: { recipes: any[]; }) => ({
          recipes: state.recipes.filter((recipe) => recipe.id !== id),
        })),

      // Updates an existing recipe
      updateRecipe: (updatedRecipe: { id: any; }) =>
        set((state: { recipes: any[]; }) => ({
          recipes: state.recipes.map((recipe) =>
            recipe.id === updatedRecipe.id ? updatedRecipe : recipe
          ),
        })),
    }),
    {
      name: 'recipe-storage', // Key for LocalStorage
    }
  )
);

export default useRecipeStore;